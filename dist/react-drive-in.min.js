/*
 * React Video - React component supporting background videos and playlists.
 * @version v1.0.0
 * @link https://github.com/ronik-design/react-drive-in
 * @license 
 * @author  ()
*/
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("react")):"function"==typeof define&&define.amd?define(["react"],e):"object"==typeof exports?exports.ReactDriveIn=e(require("react")):t.ReactDriveIn=e(t.React)}(this,function(t){return function(t){function e(o){if(i[o])return i[o].exports;var s=i[o]={exports:{},id:o,loaded:!1};return t[o].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){var o=i(1),s=i(2);t.exports=o.createClass({displayName:"DriveIn",propTypes:{show:o.PropTypes.oneOfType([o.PropTypes.string,o.PropTypes.array]),showPlaylist:o.PropTypes.oneOfType([o.PropTypes.array]),poster:o.PropTypes.string,duration:o.PropTypes.number,mute:o.PropTypes.bool,loop:o.PropTypes.bool,slideshow:o.PropTypes.bool,onPlaying:o.PropTypes.func,onPause:o.PropTypes.func},getDefaultProps:function(){return{className:"drive-in",duration:"auto",mute:!0,loop:!0,slideshow:!1,volume:.5}},getInitialState:function(){return{playlist:null,initialized:!1,playing:!1,mute:!0,currentItem:0}},getMedia:function(){return this.refs.media.getDOMNode()},getPlaylist:function(){return this.state.playlist},setPlaying:function(t){this.setState({playing:!0,currentItem:t}),this.props.onPlaying&&this.props.onPlaying(t)},setPause:function(){this.setState({playing:!1}),this.props.onPause&&this.props.onPause()},componentWillMount:function(){this.DI=new s},componentDidMount:function(){var t,e,i=this.DI;i.init({el:this.getMedia()}),t={mute:this.props.mute,duration:this.props.duration,loop:this.props.loop,poster:this.props.poster},e=this.props.showPlaylist?i.showPlaylist(this.props.showPlaylist,t):i.show(this.props.show,t),i.on("media.playing",function(t){this.setPlaying(t)}.bind(this)),i.on("media.pause",function(){this.setPause()}.bind(this)),this.setState({mute:this.props.mute,playlist:e,initalized:!0})},componentWillUnmount:function(){this.DI.removeAllListeners(),this.DI.close(),delete this.DI},play:function(t){this.DI.play(t)},pause:function(){this.DI.pause()},mute:function(){this.DI.setVolume(0),this.state.mute=!0},unmute:function(){this.DI.setVolume(this.props.volume),this.state.mute=!1},renderMedia:function(){var t;return t="ontouchstart"in window||this.props.slideshow?o.DOM.img(null):o.DOM.video({height:"1",width:"1",preload:"auto",autoplay:!0}),o.DOM.div({ref:"media",className:"drive-in-media"},t)},render:function(){return o.DOM.div({ref:"wrap",id:"drive-in-wrap",className:this.props.className},this.renderMedia())}})},function(e){e.exports=t},function(t,e,i){function o(t){for(var e,i={},o=t.children,s=0;s<o.length;s++)e=o[s],"VIDEO"!==e.nodeName||i.el||(i.type="video",i.el=e),"IMG"!==e.nodeName||i.el||(i.type="image",i.el=e);return i}function s(){return self.innerHeight?self.innerWidth:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientWidth:document.body?document.body.clientWidth:void 0}function n(){return self.innerHeight?self.innerHeight:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:document.body?document.body.clientHeight:void 0}function r(t,e){var i="";for(var o in e)i+=o+":"+e[o]+";";t.style.cssText+=";"+i}function a(t){var e={},i={mp4:!0,ogv:!0,webm:!0},o={jpg:!0,png:!0,gif:!0},s=t.match(/\.([mp4|ogv|webm|jpg|jpeg|png|gif]+)$/)[1];return i[s]&&(e.type="ogv"===s?"video/ogg":"video/"+s),o[s]&&(e.type="jpg"===s?"image/jpeg":"image/"+s),e.src=t,e}function l(t,e){e=e||0;var i,o=[];for(var s in t)i=t[s],i.constructor===Object&&o.push([i]),i.constructor===Array&&o.push(l(i,e+1)),"string"==typeof i&&o.push(0===e?[a(i)]:a(i));return o}function p(t){var e,i;for(var o in t){if(i=t[o],i.constructor===Array)e=p(i);else if(i.type.search(/^image/)>-1)return i;if(e)return e}}function h(t,e){var i,o,s=this,n=e;this.pause=function(t){window.clearTimeout(i),n-=new Date-o,t||this.emit("pause")},this.resume=function(e){o=new Date,window.clearTimeout(i),i=window.setTimeout(t,n),e||this.emit("resume")},this.destroy=function(){s.pause(!0),s.removeAllListeners()},this.resume()}function u(){this._listeners=[],this.parentEl=null,this.mediaEl=null,this.mute=!0,this.currMediaType=null,this.mediaAspect=16/9,this.playlist=null,this.loop=!0,this.playlistLength=0,this.currentItem=0,this.slideshowItemDuration=10,this._slideshowTimer=null,this.poster=null}var c=i(3),d=i(4);d(h,c),d(u,c),u.prototype._updateSize=function(){var t=document.body,e=this.parentEl,i=this.mediaEl,o=this.mediaAspect,a=this.currMediaType,l=s(),p=n(),h=t.offsetWidth<l?t.offsetWidth:l,u=t.offsetHeight<p?t.offsetHeight:p,c=h/u;"BODY"===t.nodeName&&(r(t,{height:"auto"}),p>t.offsetHeight&&(r(t,{height:"100%"}),r(document.documentElement,{height:"100%"}))),o>c?"video"==a?(r(e,{width:u*o+"px",height:u+"px"}),r(e,{height:u+"px"}),r(i,{width:u*o+"px",height:u+"px"})):r(i,{width:"auto",height:u+"px"}):"video"==a?(r(e,{width:h+"px",height:h/o+"px"}),r(e,{height:h/o+"px"}),r(i,{width:e.offsetWidth+"px",height:"auto"})):r(i,{width:h+"px",height:"auto"})},u.prototype._setVideoData=function(){var t=this.mediaEl;this.mediaAspect=t.videoWidth/t.videoHeight,this._updateSize()},u.prototype._setImageData=function(t){this.mediaAspect=t.naturalWidth/t.naturalHeight,this._updateSize()},u.prototype._playVideoItem=function(t,e){var i,o,s,n=this.mediaEl;for(var r in t)i=t[r],s=n.canPlayType(i.type),"probably"===s?o=i.src:s&&!o&&(o=i.src);o?(this.mediaEl.src=o,this.playlistLength<2&&(this.mediaEl.loop=!0),this.mute&&this.setVolume(0),this.currentItem=e,this.mediaEl.load()):this.emit("media.error",new Error("No playable source"))},u.prototype._playImageItem=function(t,e){{var i,o;this.mediaEl}for(var s in t)i=t[s],0!==i.type.search(/^image/)||o||(o=i.src);!o&&this.poster&&(o=this.poster.src),o?(this.mediaEl.src=o,this.currentItem=e):this.emit("media.error",new Error("No playable source"))},u.prototype._playItem=function(t,e){"video"===this.currMediaType&&this._playVideoItem(t,e),"image"===this.currMediaType&&this._playImageItem(t,e)},u.prototype._loadPlaylist=function(t){this.playlist=t,this.playlistLength=t.length,this._playItem(t[0],0)},u.prototype._addListener=function(t,e,i){t.addEventListener(e,i),this._listeners.push({element:t,event:e,handler:i})},u.prototype._removeAllListeners=function(){var t,e=this._listeners;for(var i in e)t=e[i],t.element.removeEventListener(t.event,t.handler)},u.prototype._attachVideoListeners=function(){function t(t){n._setVideoData(t)}function e(){n.emit("media.playing",n.currentItem)}function i(){n.emit("media.pause")}function o(){if(n.emit("media.ended",n.currentItem),n.playlistLength>1&&n.loop){var t=0;n.currentItem+1<n.playlistLength&&(t=n.currentItem+1),n.play(t)}}function s(){r.play()}var n=this,r=this.mediaEl;this._addListener(r,"loadedmetadata",t),this._addListener(r,"playing",e),this._addListener(r,"pause",i),this._addListener(r,"ended",o),this._addListener(r,"canplay",s)},u.prototype._attachImageListeners=function(){function t(){var t=new Event("ended");s.mediaEl.dispatchEvent(t)}function e(){s.emit("media.pause")}function i(){s.playlistLength>1&&(s._slideshowTimer&&s._slideshowTimer.destroy(),s._slideshowTimer=new h(t,1e3*s.slideshowItemDuration),s._slideshowTimer.on("pause",e)),s._setImageData(this),s.emit("media.playing",s.currentItem)}function o(){if(s.emit("media.ended",s.currentItem),s.playlistLength>1&&s.loop){var t=s.currentItem+1<s.playlistLength?s.currentItem+1:0;s.play(t)}}var s=this,n=this.mediaEl;this._addListener(n,"load",i),this._addListener(n,"ended",o)},u.prototype._attachListeners=function(){function t(){window.requestAnimationFrame(e._updateSize.bind(e))}var e=this;this._addListener(window,"resize",t),"video"===this.currMediaType?this._attachVideoListeners():this._attachImageListeners()},u.prototype._setParent=function(t){return this.parentEl=t,r(this.parentEl,{position:"absolute",display:"block",transform:"translate3d(-50%,-50%,0)","-webkit-transform":"translate3d(-50%,-50%,0)",left:"50%",top:"50%"}),this.parentEl},u.prototype._setMedia=function(t){return this.mediaEl=t.el,r(this.mediaEl,{display:"block"}),this.currMediaType=t.type,this.mediaEl},u.prototype.init=function(t){var e=this._setParent(t.el),i=o(e);this._setMedia(i),this._attachListeners()},u.prototype.show=function(t,e){return t.constructor===Array?this.showPlaylist([t],e):t.constructor===Object?this.showPlaylist([[t]],e):this.showPlaylist([[a(t)]],e)},u.prototype.showPlaylist=function(t,e){e.hasOwnProperty("mute")&&(this.mute=e.mute),e.hasOwnProperty("loop")&&(this.loop=e.loop);var i=l(t);this.poster=e.poster?e.poster:p(i),this._loadPlaylist(i)},u.prototype.setVolume=function(t){"image"!==this.currMediaType&&(0===t?(this.mute=!0,this.mediaEl.muted=!0,this.mediaEl.volume=0):(this.mute=!1,this.mediaEl.muted=!1,this.mediaEl.volume=t))},u.prototype.getMedia=function(){return this.mediaEl},u.prototype.getPlaylist=function(){return this.playlist},u.prototype.getItem=function(t){return this.playlist[t]},u.prototype.play=function(t){"number"==typeof t?this._playItem(this.playlist[t],t):"video"===this.currMediaType?this.mediaEl.play():this._slideshowTimer&&this._slideshowTimer.resume()},u.prototype.pause=function(){"video"===this.currMediaType?this.mediaEl.pause():this._slideshowTimer&&this._slideshowTimer.pause()},u.prototype.close=function(){this._removeAllListeners(),this._slideshowTimer&&(this._slideshowTimer.destroy(),delete this._slideshowTimer)},t.exports=u},function(t){"use strict";function e(){}e.prototype.on=function(t,e){return this._collection=this._collection||{},this._collection[t]=this._collection[t]||[],this._collection[t].push(e),this},e.prototype.once=function(t,e){function i(){o.off(t,i),e.apply(this,arguments)}var o=this;return i.listener=e,this.on(t,i),this},e.prototype.off=function(t,e){var i=this._collection[t],o=0;if(void 0!==i)for(o;o<i.length;o+=1)if(i[o]===e||i[o].listener===e){i.splice(o,1);break}return 0===i.length&&this.removeAllListeners(t),this},e.prototype.removeAllListeners=function(t){return this._collection=this._collection||{},delete this._collection[t],this},e.prototype.listeners=function(t){return this._collection=this._collection||{},this._collection[t]},e.prototype.emit=function(){if(void 0===this._collection)return this;var t,e=[].slice.call(arguments,0),i=e.shift(),o=this._collection[i],s=0;if(o)for(o=o.slice(0),t=o.length,s;t>s;s+=1)o[s].apply(this,e);return this},t.exports=e},function(t){t.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}}])});
//# sourceMappingURL=react-drive-in.min.js.map